---
title: "FinalLehmann"
author: "Ben Lehmann"
date: "2023-05-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

We have a dataset of test scores (Math, Reading, Writing), with different variables, Gender, Race, If they have college education or not, if they have completed test prep.

Now I want to look at the average score (Math+Reading+Writing/3) and compare them by race and gender

I also want to look at Scores by Race and Gender



```{r}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(tidyr)
```

```{r}
students <- read_csv("~/DS202RWork/StudentsPerformance.csv")


namesOfColumns <- c("Gender","Race","Parent_Education","Lunch","Test_Prep","Math_Score","Reading_Score","Writing_Score")
colnames(students) <- namesOfColumns

students <- students %>% mutate (Avg.score = (Reading_Score + Math_Score + Writing_Score)/3)
```
```{r}
students %>% group_by(Gender)%>% summarise(n=n()) %>% ggplot(aes(Gender,n,fill=Gender))+geom_col()
```
```{r}
students %>% group_by(Race, Gender) %>% summarise(n = n()) %>% 
  ggplot(aes(x = reorder(Race, -n), y = n, fill = Gender)) + 
  geom_col(position = 'dodge')
``
`
```{r}
students %>% keep(is.numeric) %>%
  gather() %>%
  ggplot(aes(value))+
  facet_wrap(~key, scale = "free")+
  geom_histogram(aes(y=..density..), fill= "lightblue")
```
I want to look at the overall distribution of scores, not focusing at any certain variable.




```{r}
p <- ggplot(students, aes(Math_Score)) + geom_histogram(binwidth=5, color="black", aes(fill=Gender))
p
```
```{r}
p_new <- ggplot(students, aes(Reading_Score)) + geom_histogram(binwidth=5, color="black", aes(fill=Gender))
p_new
```
```{r}
p3 <- ggplot(students, aes(Writing_Score)) + geom_histogram(binwidth=5, color="black", aes(fill=Gender))
p3
```
```{r}
students %>% group_by(Race) %>% summarise(new_mean=round(sum(Avg.score)/n(),2)) %>% ggplot(aes(Race,new_mean,fill=Race))+geom_bar(stat='identity')+geom_text(aes(label = new_mean))
```

Now, Let's look at the average score by Gender, We can see the Females perform better than Men in Testing

```{r}
students %>% group_by(Gender) %>% summarise(new_mean=round(sum(Avg.score)/n(),2)) %>% ggplot(aes(Gender,new_mean,fill=Gender))+geom_bar(stat='identity')+geom_text(aes(label = new_mean))
```



